<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>main</title>
		<meta name="author" content="Junxin" />
		<!-- Date: 2014-06-17 -->
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
		<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
		<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
		<script type="text/javascript" src="phonegap.js"></script>
		<script type="text/javascript" charset="utf-8" src="js/rockpaperscissors.js"></script>
		<script type="text/javascript" charset="utf-8" src="js/compare.js"></script>
		<link rel="stylesheet" type="text/css" href="css/rps.css" />
		<link rel="stylesheet" type="text/css" href="css/life.css" />
		<link rel="stylesheet" type="text/css" href="css/main.css" />
		<script>
			var makeUnselectable = function($target) {
				$target.addClass('unselectable')// All these attributes are inheritable
				.attr('unselectable', 'on')// For IE9 - This property is not inherited, needs to be placed onto everything
				.attr('draggable', 'false')// For moz and webkit, although Firefox 16 ignores this when -moz-user-select: none; is set, it's like these properties are mutually exclusive, seems to be a bug.
				.on('dragstart', function() {
					return false;
				});
				// Needed since Firefox 16 seems to ingore the 'draggable' attribute we just applied above when '-moz-user-select: none' is applied to the CSS

				$target// Apply non-inheritable properties to the child elements
				.find('*').attr('draggable', 'false').attr('unselectable', 'on');
			};
			$('body').addClass('noscroll').css('top', -(document.documentElement.scrollTop) + 'px');

		</script>
	</head>
	<body>
		<div align="center">
			<input type="button" onclick="play()" value="start"\>
			<div id="life">
				<img src="img/rps/blood.png" id="pBlood">
				<img src="img/rps/life.png" id="pLife">
				<img src="img/rps/blood.png" id="eBlood">
				<img src="img/rps/life.png" id="eLife">
			</div>
			<div id="rps">
				<img src="img/rps/line.png" id="line1">
				<img src="img/rps/line.png" id="line2">
				<img src="img/rps/line.png" id="line3">
				<img src="img/rps/paper.png" id="paper" onclick="add(this.id)">
				<img src="img/rps/rock.png" id="rock" onclick="add(this.id)">
				<img src="img/rps/scissors.png" id="scissors" onclick="add(this.id)">
			</div>
			<div id="compare"></div>
			<div id="motion">
				<img src=# id="player">
				<img src=# id="computer">
			</div>
		</div>
		<script type="text/javascript">
			var playermove = new Array();
			var computermove = new Array();
			var rps = ["rock", "paper", "scissors"];
			var start = 40;
			var end = 80;
			var position = start;
			document.getElementById("player").src = "img/knight/brond/Ready.png";
			document.getElementById("computer").src = "img/knight/brond/Ready.png";

			document.addEventListener("deviceready", onDeviceReady, false);
			window.addEventListener('orientationchange', doOnOrientationChange);
			doOnOrientationChange();

			function onDeviceReady() {
			}

			/*
			 * This  function is for orientation
			 */
			function doOnOrientationChange() {
				switch(window.orientation) {
					case -90:
					case 90:
						$("#life").css({"top":"10px","left":"120px"});
						$("#rps").css({"top":"30px","left":"-80px"});
						$("#compare").css({"top":"60px","left":"-180px"});
						$("#motion").css({"top":"100px","right":"-120px"});
						break;
					default:
						$("#life").css({"top":"auto","left":"auto"});
						$("#rps").css({"top":"80px","left":"70px"});
						$("#compare").css({"top":"80px","left":"auto"});
						$("#motion").css({"top":"300px","right":"auto"});
						break;
				}
			}

			/*
			 * set up random array for computer
			 * inital RPS js
			 * intial Compare js
			 * use fight() method display motion
			 * reset arrays
			 */
			function play() {
				
				for (var i = 0; i < 10; i++) {
					computermove.push(rps[Math.floor(Math.random() * 3)]);
				}
				document.getElementById("compare").innerHTML = initCompare(computermove, playermove);
				startpCompare(0);
				starteCompare(0);
				var size = Math.max(computermove.length, playermove.length);
				for (var i = 0; i < size; i++) {
					var eshow = computermove.shift();
					var pshow = playermove.shift();
					initRPS(eshow, pshow);
					fight(getComputer(), getPlayer());
				}
			}

			/*
			 * hide or display rps
			 * display or hide compare
			 */

			/*
			 * set up the time interval
			 * when motion finish hide compare and display rps triangle
			 */
			function fight(computer, player) {
				var p = "#player";
				var e = "#computer";
				var time = [600, 300, 20];
				var pixal = ["40px", "80px", "70px"];
				var pgetpxstart = {
					opacity : '1'
				};
				var egetpxstart = {
					opacity : '1'
				};
				var pgetpxend = {
					opacity : '1'
				};
				var egetpxend = {
					opacity : '1'
				};
				var pgetpxmove = {
					opacity : '1'
				};
				var egetpxmove = {
					opacity : '1'
				};

				pgetpxstart["left"] = pixal[0];
				egetpxstart["right"] = pixal[0];
				pgetpxend["left"] = pixal[1];
				egetpxend["right"] = pixal[1];
				pgetpxmove["left"] = pixal[2];
				egetpxmove["right"] = pixal[2];

				//player motion:
				$(p).animate(pgetpxstart, time[0], function() {
					$(p).attr("src", "img/knight/brond/" + player.shift()).css("opacity", "0");
				}).animate(pgetpxend, time[1], function() {
					$(p).attr("src", "img/knight/brond/" + player.shift());
				}).animate(pgetpxmove, time[1]).animate(pgetpxend, time[2]).animate(pgetpxmove, time[2]).animate(pgetpxend, time[2]).animate(pgetpxmove, time[2]).animate(pgetpxend, time[2]).animate(pgetpxmove, time[2]).animate(pgetpxend, time[1], function() {
					$(p).attr("src", "img/knight/brond/" + player.shift()).css("opacity", "0");
				}).animate(pgetpxstart, time[1], function() {
					$(p).attr("src", "img/knight/brond/" + player.shift());
				});

				//computer motion:
				$(e).animate(egetpxstart, time[0], function() {
					$("#computer").attr("src", "img/knight/brond/" + computer.shift()).css("opacity", "0");
				}).animate(egetpxend, time[1], function() {
					$("#computer").attr("src", "img/knight/brond/" + computer.shift());
				}).animate(egetpxmove, time[1]).animate(egetpxend, time[2]).animate(egetpxmove, time[2]).animate(egetpxend, time[2]).animate(egetpxmove, time[2]).animate(egetpxend, time[2]).animate(egetpxmove, time[2]).animate(egetpxend, time[1], function() {
					$("#computer").attr("src", "img/knight/brond/" + computer.shift()).css("opacity", "0");
				}).animate(egetpxstart, time[1], function() {
					$("#computer").attr("src", "img/knight/brond/" + computer.shift());
				});

			}

			//display how much charaters life left
			function accessLife(charater, i) {
				var w = {
					"width" : Math.floor(82 * i) + "px"
				};
				$(charater).animate(w);
			}

			//Add rock, paper, or scissors into array
			function add(id) {
				playermove.push(id);
			}
		</script>
	</body>
</html>
